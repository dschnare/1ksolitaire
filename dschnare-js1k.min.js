c.width=c.height=600;A();
function A(){function v(d,e,f){d[3]=1;a.save();a.fillStyle="#fff";a.fillRect(e,f,r,t);a.strokeRect(e,f,r,t);a.fillStyle=d[1]%2?"red":"#000";a.translate(e+5,f+20);a.scale(2,2);a.fillText(d[0],0,0);a.restore()}function w(s,k,n,l){c.width=600;if(1==h)g.length?p.push.apply(p,g.splice(-3).reverse()):(g=p.slice(),g.reverse(),p=[]);else if(h)for(f=h[0],e=10;~e;e--)if(n=q[e],d=n[n.length-1],6<e?h[2]==h[1].length-1&&(!d&&1==f[2]||d&&f[1]==d[1]&&f[2]==d[2]+1)&&(l=1):d||13!=f[2]?d&&(f[1]%2!=d[1]%2&&f[2]==d[2]-
1)&&(l=1):l=1,l){if(l=h[1][h[2]-1])l[3]=1;n.push.apply(n,h[1].splice(h[2]));break}a.fillStyle="red";for(e=10;~e;e--)for(d=0,m=q[e].length;d<m;d++)f=q[e][d],s=u*(e%7),k=6<e?0:x+y*d,f[3]?v(f,s,k):(a.fillRect(s,k,r,t),a.strokeRect(s,k,r,t));s=6*u;k=0;g.length&&a.fillRect(s,k,r,t);a.strokeRect(s,k,r,t);p.length&&v(p[p.length-1],7*u,0);h=0;setTimeout(w,16.66)}var e,d,m,f,z,g=[],p=[],B=["\u2660","\u2665","\u2663","\u2666"],q=[],x=100,r=50,t=60,u=r+25,y=20,h;for(e=51;~e;e--)f=e%13+1,z=B[d=e/13>>0],g[e]=
[(1==f?"A":f)+z,d,f,0];g=g.sort(function(){return 0.5>Math.random()?-1:1});e=0;for(m=7;e<m;e++)for(d=e;d<m;d++)(q[d]=q[d]||[]).push(f=g.pop()),f[3]=e==d;q.push([],[],[],[]);c.addEventListener("mouseup",function(f){function k(){return n>=g&&n<=g+r&&l>=m&&l<=m+t}var n=f.clientX,l=f.clientY,g,m;f=c.getBoundingClientRect();h=0;n-=f.left;l-=f.top;for(e=6;~e;e--)for(d=q[e].length-1;~d;d--){f=q[e][d];g=u*e;m=x+d*y;if(!f[3])break;if(k())return h=[f,q[e],d]}g=6*u;m=0;if(k())return h=1;g=7*u;m=0;d=p.length-
1;f=p[d];k()&&(h=[f,p,d])});w()};
